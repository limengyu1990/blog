<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/blog/img/favicon.ico">

    <title>
        
        Plutus-Pioneer-lesson-01 - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/blog/css/aircloud.css">
    <link rel="stylesheet" href="/blog/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 所有的善恶都是我，良心一路走来依旧清澈鲜活... </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/blog/img/photo.png" />
        </div>
        <div class="name">
            <i>不负如来不负卿</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/blog/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/blog/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/blog/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/blog/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境配置"><span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nix"><span class="toc-text">nix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#课程01"><span class="toc-text">课程01</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#启动模拟器"><span class="toc-text">启动模拟器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第一节课"><span class="toc-text">第一节课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#拍卖流程"><span class="toc-text">拍卖流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#评估"><span class="toc-text">评估</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他"><span class="toc-text">其他</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> 所有的善恶都是我，良心一路走来依旧清澈鲜活... </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Plutus-Pioneer-lesson-01
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2021-04-08 20:00:00</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/blog/tags/#Haskell" title="Haskell">Haskell</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#Plutus" title="Plutus">Plutus</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#DApps" title="DApps">DApps</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#智能合约" title="智能合约">智能合约</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#Cardano" title="Cardano">Cardano</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#Pioneer" title="Pioneer">Pioneer</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#slot" title="slot">slot</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#epoch" title="epoch">epoch</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#Contract" title="Contract">Contract</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#nix" title="nix">nix</a>
        <span>/</span>
        
        <a class="tag" href="/blog/tags/#拍卖" title="拍卖">拍卖</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <blockquote>
<p>Plutus Pioneer创新计划旨在在Cardano生态系统内招募和培训开发人员，以便在今年晚些时候将Plutus部署到Cardano主网时为他们做好充分的准备。本次课程为期10周，每周2发布新的课程，该课程涵盖: 函数与数据类型/类型类/Monads/Template Haskell/Plutus游乐场/EUTXO模型/链上与链下代码/Minting策略/状态机/Plutus应用框架/案例研究与实践练习等。于此同时，为了奖励参与者为参加此课程而付出的努力，并对完成整个计划并取得成功的Pioneers进行认证。这些Plutus Pioneer证书将被表示为不可替代的令牌(在测试网上)，并被Plutus合同锁定。Pioneers可以通过构建适当的交易来解锁其个人令牌来证明自己的知识和资格。</p>
</blockquote>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>这里介绍<code>macos</code>环境，<code>windows</code>环境可以使用<code>wsl-linux</code>.</p>
<h3 id="nix"><a href="#nix" class="headerlink" title="nix"></a>nix</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 安装nix</span><br><span class="line">sh &lt;(curl -L https://nixos.org/nix/install) --darwin-use-unencrypted-nix-store-volume</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 编辑~/.config/nix/nix.conf文件，设置 IOHK 二进制缓存</span><br><span class="line">substituters        = https://hydra.iohk.io https://iohk.cachix.org https://cache.nixos.org/</span><br><span class="line">trusted-public-keys = hydra.iohk.io:f/Ea+s+dFdN+3Y/G+FDgSq+a5NEWhJGzdjvKNGv0/EQ= iohk.cachix.org-1:DpRUyj7h7V830dp/i6Nti+NEO2/nhblbov/8MW7Rqoo= cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY=</span><br><span class="line"></span><br><span class="line">sandbox = true</span><br><span class="line">extra-sandbox-paths = /System/Library/Frameworks /System/Library/PrivateFrameworks /usr/lib /private/tmp /private/var/tmp /usr/bin/env</span><br></pre></td></tr></table></figure>
<h3 id="课程01"><a href="#课程01" class="headerlink" title="课程01"></a>课程01</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 例如: 安装在用户主目录的haskell文件夹下</span><br><span class="line">cd ~/haskell</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> clone 课程仓库(pioneer)</span><br><span class="line">git clone https://github.com/input-output-hk/plutus-pioneer-program.git</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> clone plutus项目</span><br><span class="line">git clone https://github.com/input-output-hk/plutus.git</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 查看commit id(3746610e53654a1167aeb4c6294c6096d16b0502)</span><br><span class="line">head -30 ~/haskell/plutus-pioneer-program/code/week01/cabal.project</span><br><span class="line">output: 3746610e53654a1167aeb4c6294c6096d16b0502</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 进入到plutus目录, 检出特定commit id</span><br><span class="line">cd ~/haskell/plutus</span><br><span class="line">git checkout 3746610e53654a1167aeb4c6294c6096d16b0502</span><br><span class="line"><span class="meta">#</span> 构建plutus</span><br><span class="line">nix build -f default.nix plutus.haskell.packages.plutus-core.components.library</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 启动nix环境</span><br><span class="line">nix-shell #(wait for it to load)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 进入到课程01目录，构建</span><br><span class="line">cd ~/haskell/plutus-pioneer-program/code/week1/</span><br><span class="line">cabal update</span><br><span class="line">cabal build</span><br></pre></td></tr></table></figure>
<h2 id="启动模拟器"><a href="#启动模拟器" class="headerlink" title="启动模拟器"></a>启动模拟器</h2><p>完成上述步骤后，可以启动模拟器:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 新开一个终端，启动服务器</span><br><span class="line">cd ~/haskell/plutus/plutus-playground-server</span><br><span class="line">nix-shell # (wait for it to load)</span><br><span class="line">plutus-playground-server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 再打开一个终端，启动客户端</span><br><span class="line">cd ~/haskell/plutus/plutus-playground-client</span><br><span class="line">nix-shell # (wait for it to load)</span><br><span class="line">npm run start</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 打开浏览器: </span><br><span class="line">https://localhost:8009/</span><br></pre></td></tr></table></figure>
<h2 id="第一节课"><a href="#第一节课" class="headerlink" title="第一节课"></a>第一节课</h2><p>启动模拟器后，将默认代码删除，然后将<code>~/haskell/plutus-pioneer-program/code/week01/src/Week01/EnglishAuction.hs</code>文件的内容拷贝进来，并将模块导入的相关代码删除:<br><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除如下代码</span></span><br><span class="line"><span class="keyword">module</span> Week01.EnglishAuction</span><br><span class="line">    ( <span class="type">Auction</span> (..)</span><br><span class="line">    , StartParams (..), BidParams (..), CloseParams (..)</span><br><span class="line">    , AuctionSchema</span><br><span class="line">    , start, bid, close</span><br><span class="line">    , endpoints</span><br><span class="line">    , schemas</span><br><span class="line">    , ensureKnownCurrencies</span><br><span class="line">    , printJson</span><br><span class="line">    , printSchemas</span><br><span class="line">    , registeredKnownCurrencies</span><br><span class="line">    , stage</span><br><span class="line">    ) <span class="keyword">where</span></span><br></pre></td></tr></table></figure></p>
<p>点击<code>compile</code>按钮，编译合同代码。<br>点击<code>simulate</code>按钮，将会模拟该合同。</p>
<p>课程01的合同代码逻辑为:<br>钱包1准备拍卖<code>NFT</code>令牌(1<code>T</code>)，钱包2和钱包3将竞标(通过<code>添加钱包</code>按钮可以增加更多钱包).<br>每个钱包都有<code>bid</code>(出价)，<code>close</code>(关闭)，<code>start</code>(启动)三个按钮。</p>
<ul>
<li><code>bid</code>   -&gt; 出价<code>x</code> <code>lovelaces</code></li>
<li><code>start</code> -&gt; 使用<code>getSlot</code>(竞价持续多长时间)和<code>spMinBid</code>(最小<code>lovelaces</code>限制)来启动竞标过程</li>
<li><code>close</code> -&gt; 关闭竞标，将<code>NFT</code>令牌给到最高出价者</li>
</ul>
<p>默认每个钱包都有10个<code>lovelaces</code>和10个<code>T</code>, 钱包1将会发起拍卖，因此我们将钱包1的<code>T</code>改为1，钱包2和钱包3的<code>T</code>改为0:<br><img src="01.png" alt=""></p>
<h3 id="拍卖流程"><a href="#拍卖流程" class="headerlink" title="拍卖流程"></a>拍卖流程</h3><ol>
<li>因为钱包1将会拍卖自己的令牌<code>T</code>，因此我们需要为钱包1增加一个<code>start</code>动作(点击钱包1的<code>start</code>按钮)，并设置相应参数:</li>
</ol>
<ul>
<li>getSlot: 20(竞标将在<code>slot</code>20上<code>close</code>)</li>
<li>spMinBid: 3(至少需要3个<code>lovelaces</code>)</li>
<li>spCurrency: 66(<code>T</code>令牌的货币符号, 将在以后的课程中进行解释)</li>
<li>spToken: <code>T</code>(令牌)</li>
</ul>
<p><img src="02.png" alt=""></p>
<ol>
<li>然后我们需要添加一个<code>wait</code>动作(1<code>slot</code>), 这将使所有<code>action</code>有时间执行。</li>
</ol>
<p><img src="03.png" alt=""></p>
<ol start="3">
<li>现在钱包2将出价3个<code>lovelaces</code>来开始竞标。<br>点击钱包2上的<code>bid</code>按钮，然后使用以下参数更新操作:</li>
</ol>
<ul>
<li>spCurrency: 66(<code>T</code>令牌的货币符号, 将在以后的课程中进行解释)</li>
<li>spToken: <code>T</code>(令牌)</li>
<li>bpBid: 3(出价多少个<code>lovelaces</code>)</li>
</ul>
<p><img src="04.png" alt=""></p>
<ol start="4">
<li><p>然后再次增加一个<code>wait</code>动作(1<code>slot</code>)<br><img src="03.png" alt=""></p>
</li>
<li><p>然后钱包3开始出价(点击钱包3上的<code>bid</code>按钮)(使用5个<code>lovelaces</code>):<br><img src="05.png" alt=""></p>
</li>
<li><p>然后我们再次增加一个<code>wait</code>动作，选择<code>wait until</code>,然后填写<code>20 slot</code>(注意: 在第1步时，我们已设置在20 <code>slot</code>时<code>close</code>竞标过程)<br><img src="06.png" alt=""></p>
</li>
<li><p>然后，我们还需要为钱包1增加一个<code>close</code>动作，来确定最终投标顺序.<br><img src="07.png" alt=""></p>
</li>
<li><p>最后，在增加一个<code>wait</code>动作(1<code>slot</code>)<br><img src="03.png" alt=""></p>
</li>
</ol>
<h3 id="评估"><a href="#评估" class="headerlink" title="评估"></a>评估</h3><p>完成如上过程后，我们需要点击<code>Evaluate</code>按钮来完成评估。<br>你将会看到如下各个<code>slots</code>内容:<br><img src="08.png" alt=""></p>
<ul>
<li>Slot 0, Tx 0 <ul>
<li><code>Genesis</code>(创始)<code>slot</code>, 在这将会设置所有内容: 钱包1有1个<code>T</code>和10个<code>lovelaces</code>, 钱包2和钱包3分别有10个<code>lovelaces</code></li>
</ul>
</li>
<li>Slot 1, Tx 0 <ul>
<li><code>start</code>动作，这是钱包1将它的1<code>T</code>转移到合同中的地方</li>
</ul>
</li>
<li>Slot 2, Tx 0 <ul>
<li>钱包2出价3个<code>lovelaces</code>, 此时合同中有1个<code>T</code>和3个<code>lovelaces</code>.</li>
</ul>
</li>
<li>Slot 3, Tx 0<ul>
<li>钱包3出价5个<code>lovelaces</code>, 此时合同中有1个<code>T</code>和5个<code>lovelaces</code>, 钱包2的3个<code>lovelaces</code>已被退回</li>
</ul>
</li>
<li>Slot 20, Tx 0<ul>
<li>钱包3赢得最终的竞标，得到了1个<code>T</code>, 钱包1得到了5个<code>lovelaces</code>. 此时合同中没有任何东西，它已经将所有东西交给了其合法所有者.</li>
</ul>
</li>
</ul>
<p>检查<code>Final balances</code>，可以看到最终结果，钱包3现在有1个<code>T</code>:<br><img src="09.png" alt=""></p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><blockquote>
<p><code>Cardano</code>的时间划分为了几个<code>epoch</code>(纪元)，然后每个<code>epoch</code>再次被划分为<code>slots</code>(插槽),<code>slot</code>是可以创建<code>block</code>(块)的较短时间段, <code>Ouroboros</code>股权证明算法，为每个<code>slot</code>随机分配一个<code>stake pool</code>(股份池), 然后，所谓的<code>slot leader</code>为此<code>slot</code>创建相应的<code>block</code>, 在创建<code>epoch</code>之前，已经进行了<code>slot leader</code>的选举。每个<code>slot</code>通常都包含一个<code>block</code>，但是如果所选的池性能不好，则可能不时有一个空<code>slot</code>。对于<code>Cardano</code>协议，空<code>slot</code>是可以的，但是大多数<code>block</code>必须在一个<code>epoch</code>期间生成，以保持有保证的安全性。每20秒有一个<code>slot</code>，每个<code>epoch</code>包含21600个<code>slots</code>。因此，每5天就有一个新<code>epoch</code>。</p>
</blockquote>
<p><img src="10.png" alt=""></p>
<p><code>/</code>表示空<code>slot</code></p>
<blockquote>
<p><code>Cardano</code>的设计方式是可以并行运行多个<code>epoch</code>。如果假设单线程性能为每秒<code>X</code>个事务，并且并行运行另一个<code>epoch</code>，那么现在的性能是原来每秒事务量的两倍。如果并行运行另一个<code>epoch</code>，则性能将变为每秒原始事务量的3倍，依此类推。您可以并行运行多达<code>N</code>个<code>epoch</code>，无论网络的需求是什么。<code>N</code>仅受网络吞吐量的限制。这使得<code>Cardano</code>具有高度的可扩展性.</p>
</blockquote>
<p><img src="11.png" alt=""></p>

        
            <div class="donate-container">
    <div class="donate-button">
        <button id="donate-button">赞赏</button>
    </div>
    <div class="donate-img-container hide" id="donate-img-container">
        <img id="donate-img" src="" data-src="/blog/img/pay.png">
        <p> thank you </p>
    </div>
</div>
        
        <div id="comment-container">
        </div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a href="https://medium.com/netflix-techblog">Netflix</a></span>
        <span>/</span>
        
        <span><a href="https://engineering.linkedin.com/blog">Linkedin</a></span>
        <span>/</span>
        
        <span><a href="https://blogs.dropbox.com/tech/">Dropbox</a></span>
        <span>/</span>
        
        <span><a href="https://code.fb.com/">Facebook</a></span>
        <span>/</span>
        
        <span><a href="https://www.fpcomplete.com/blog">FPComplete</a></span>
        <span>/</span>
        
        <span><a href="https://blog.janestreet.com/">JaneStreet</a></span>
        <span>/</span>
        
        <span><a href="https://github.com/limengyu1990/">Github</a></span>
        <span>/</span>
        
        <span><a href="https://serokell.io/blog">serokell</a></span>
        <span>/</span>
        
        <span><a href="https://iohk.io/en/blog">IOHK</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/blog/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/blog/js/index.js"></script>

<!--create by tea9-->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <script>
        var gitalk = new Gitalk({
          clientID: '7cfc73dd62b57f07ed83',
          clientSecret: 'dd03b7e54aadf0d81e4c9c93e23a41272bcfcfa1',
          repo: 'blog',
          owner: 'limengyu1990',
          admin: 'limengyu1990',
          id: location.pathname,      // Ensure uniqueness and length less than 50
          distractionFreeMode: false  // Facebook-like distraction free mode
        })
        gitalk.render('comment-container')
    </script>

<!--end-->


</html>
